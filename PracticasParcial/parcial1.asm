PB EQU 31H
CB EQU 33H
PIC EQU 20H
N_F10 EQU 10

ORG 40
IP_F10 DW RUT_F10

ORG 3000H
RUT_F10: PUSH AX
CMP DH, 0FFH
JZ RESET
CMP CL, 0
JZ ULTIMOS_DOS
MOV AH, CL
EXP: ADD CH, CH
DEC AH
JNZ EXP
ADD DH, CH
MOV CH, 2
DEC CL
JMP FINRUT
RESET: MOV DH, 0
MOV CL, 6
MOV CH, 2
JMP FINRUT
ULTIMOS_DOS: CMP DH, 252
JNZ SALTEAR
ADD DH, 2
JMP FINRUT
SALTEAR: MOV DH, 0FFH
FINRUT: MOV AL, 20H
OUT PIC, AL
POP AX 
IRET

ORG 2000H
MOV DH, 0
MOV CL, 6
MOV CH, 2
MOV AL, 0
OUT CB, AL
CLI
MOV AL, 0FEH
OUT PIC+1, AL
MOV AL, N_F10
OUT PIC+4, AL
STI
POLL: MOV AL, DH
OUT PB, AL
JMP POLL
HLT
END