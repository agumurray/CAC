PIO EQU 30H
TIMER EQU 10H
PIC EQU 20H
N_TIMER EQU 10

ORG 40
IP_TIMER DW RUT_TIMER

ORG 3000H
RUT_TIMER: PUSH AX
CMP CH, 0
JNZ PRENDER_IZQ
IN AL, PIO+1
CMP AL, 80H
JZ CAMBIAR
ADD AL,AL
OUT PIO+1, AL
JMP FINRUT
CAMBIAR: NOT CH
JMP FINRUT
PRENDER_IZQ: IN AL, PIO+1
DIVIDIR: CMP AL, 0
JZ FIN_DIVISION
INC DL
SUB AL, 2
JMP DIVIDIR
FIN_DIVISION: MOV AL, DL
MOV DL, 0
OUT PIO+1, AL
CMP AL, 1
JNZ FINRUT
NOT CH
FINRUT: MOV AL, 0
OUT TIMER, AL
MOV AL, 20H
OUT PIC, AL
POP AX
IRET

ORG 2000H
MOV AL, 1
OUT PIO+1, AL
MOV AL, 0
OUT PIO+3, AL
MOV DL, 0
MOV CH, 0
CLI 
MOV AL, 0FDH
OUT PIC+1, AL
MOV AL, N_TIMER
OUT PIC+5, AL
MOV AL, 0
OUT TIMER, AL
MOV AL, 1
OUT TIMER+1, AL
STI
LAZO: JMP LAZO
HLT 
END 
